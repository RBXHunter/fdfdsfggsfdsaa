-- Скрипт замены анимации для главного загрузчика
-- Хостится на raw GitHub: https://raw.githubusercontent.com/username/repository/main/4skill_sonic.lua

local Players = game:GetService("Players")
local task = task

local player = Players.LocalPlayer

local connections = {}

local OLD_ANIMATION_ID = "rbxassetid://13501296372" -- 4 skill
local NEW_ANIMATION_ID = "rbxassetid://16746824621" -- 4 skill bang

local function isEnabled()
    return _G.isScriptEnabled ~= false
end

local function handleAnimations(character)
    if not isEnabled() then return end
    local humanoid = character:WaitForChild("Humanoid", 5)
    local animator = humanoid and humanoid:FindFirstChildOfClass("Animator")
    if not animator then
        -- Без предупреждений в консоль
        return
    end

    local animationConnection = animator.AnimationPlayed:Connect(function(track)
        if not isEnabled() then return end
        if track.Animation.AnimationId == OLD_ANIMATION_ID then
            track:Stop()

            local newAnimation = Instance.new("Animation")
            newAnimation.AnimationId = NEW_ANIMATION_ID

            local newTrack = animator:LoadAnimation(newAnimation)
            newTrack:Play(0, 1, 4)
        end
    end)

    table.insert(connections, animationConnection)
end

if player.Character then
    task.spawn(handleAnimations, player.Character)
end
local characterConnection = player.CharacterAdded:Connect(handleAnimations)
table.insert(connections, characterConnection)

local function cleanup()
    for _, connection in pairs(connections) do
        if connection then
            pcall(function()
                connection:Disconnect()
            end)
        end
    end
    connections = {}
    local char = player.Character
    if char then
        local humanoid = char:FindFirstChild("Humanoid")
        if humanoid then
            for _, track in pairs(humanoid:GetPlayingAnimationTracks()) do
                if track.IsPlaying then
                    track:Stop()
                end
            end
        end
    end
end

game:BindToClose(cleanup)

task.spawn(function()
    while isEnabled() do
        task.wait(0.5)
    end
    cleanup()
end)
